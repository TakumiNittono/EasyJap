# 📝 Japanese Writing Master – ライティング特化Webアプリ要件定義書

## 1. プロダクト定義

### プロダクト名
**Japanese Writing Master** – Master Japanese Writing from ZERO

### 目的（最重要）
日本語を完全に書けるようになることに特化したWebアプリ
- 筆順を正確に覚える
- 美しい文字を書けるようになる
- 繰り返し練習で定着させる
- **成功指標は「書けるようになった」という実感**

### ターゲットユーザー
- 日本語学習者（初心者〜中級者）
- ひらがな・カタカナを書けるようになりたい人
- 筆順を正確に覚えたい人
- 美しい文字を書きたい人
- PC・タブレット・スマートフォンで学習したい人

---

## 2. 成功指標（KPI）

### 最優先KPI
- **Writing Accuracy**: 筆順の正確性 80%以上
- **Completion Rate**: レッスン完了率 70%以上
- **Retention Rate**: Day7 Retention 40%以上

### 副次KPI
- 平均練習時間: 10分/セッション
- 文字の美しさスコア: 平均70点以上
- 筆順エラー率: 20%以下
- ページ読み込み時間: 3秒以内
- モバイル対応率: 100%

---

## 3. コア機能（MVP）

### 実装するもの（必須）

#### 3.1 筆順ガイド機能
- **アニメーション筆順表示**
  - 各文字の正しい筆順をアニメーションで表示
  - 速度調整可能（遅い/普通/速い）
  - 繰り返し再生可能
  - 各画の開始点・終了点を明確に表示
  - SVGまたはCanvasを使用した滑らかなアニメーション

- **筆順データ**
  - ひらがな46文字の正確な筆順データ
  - カタカナ46文字の正確な筆順データ
  - 各画の座標データ（SVG形式またはJSON形式）

#### 3.2 なぞり書き練習機能
- **ガイドライン表示**
  - 薄いグレーで文字のガイドを表示
  - 筆順に沿ったガイドライン
  - 各画の開始点・終了点を明確に表示

- **リアルタイムフィードバック**
  - 筆順が正しいかリアルタイムで判定
  - 間違った筆順の場合は警告表示
  - 正しい筆順の場合は緑色で表示
  - タッチ/マウス入力に対応

- **筆圧・速度の可視化**
  - 書いた線の太さで筆圧を表現（タッチデバイスの場合）
  - 速度に応じた色の変化（オプション）

#### 3.3 自由書き練習機能
- **白紙キャンバス**
  - ガイドなしで自由に書く練習
  - グリッド表示オプション
  - マス目表示オプション

- **自動採点機能**
  - 筆順の正確性（40点）
  - 文字の形の正確性（30点）
  - バランス・美しさ（30点）
  - 合計100点満点

#### 3.4 進捗管理機能
- **文字別進捗**
  - 各文字の練習回数
  - 最高スコア
  - 最後の練習日
  - 習熟度レベル（初級/中級/上級）

- **統計情報**
  - 総練習時間
  - 総練習回数
  - 習得済み文字数
  - 週間/月間の練習記録

#### 3.5 練習モード
- **筆順モード**
  - 筆順を重視した練習
  - 筆順エラーを厳しく判定

- **美文字モード**
  - 文字の美しさを重視
  - バランスと形の正確性を判定

- **スピードモード**
  - 時間制限付き練習
  - 素早く正確に書く練習

### 実装しないもの（意図的に除外）
- 音声機能（ライティング特化のため）
- 単語学習
- 会話練習
- ゲーム要素（通貨、アバターなど）
- ソーシャル機能
- クラウド同期（MVPではブラウザ内保存のみ）
- ユーザー認証（MVPでは不要）

---

## 4. 画面構成

### ① ホーム画面
**目的**: 練習の開始と進捗の確認

**UI要素**:
- ヘッダー
  - アプリ名「Japanese Writing Master」
  - 今日の練習時間表示

- 進捗サマリーカード
  - 全体進捗率（円形プログレス）
  - 習得済み文字数 / 総文字数
  - 今週の練習時間

- クイックアクション
  - 「ひらがなを練習する」ボタン
  - 「カタカナを練習する」ボタン
  - 「続きから練習する」ボタン

- 最近の練習
  - 最近練習した文字3つ
  - 各文字のスコア表示

- 統計カード
  - 連続練習日数
  - 総練習時間
  - 習得済み文字数

### ② 文字選択画面
**目的**: 練習する文字を選択

**UI要素**:
- レッスンタイプ選択
  - ひらがな / カタカナ タブ

- 文字グリッド表示
  - 50音順に文字をグリッド表示
  - レスポンシブデザイン（モバイル/タブレット/PC対応）
  - 各文字の習熟度を色で表示
    - 未練習: グレー
    - 初級: オレンジ
    - 中級: ブルー
    - 上級: グリーン

- 検索機能
  - 文字で検索
  - 習熟度でフィルタ

- 文字カード
  - 文字の表示
  - 習熟度レベル
  - 最高スコア
  - 練習回数

### ③ 筆順ガイド画面
**目的**: 正しい筆順を学習

**UI要素**:
- 大きな文字表示エリア（中央）
  - アニメーション筆順表示（SVG/Canvas）
  - 現在の画をハイライト
  - 次の画を薄く表示

- コントロール
  - 再生/一時停止ボタン
  - 速度調整スライダー
  - 繰り返し再生ボタン
  - 前の画/次の画ボタン

- 筆順情報
  - 総画数
  - 現在の画数
  - 筆順の説明（オプション）

- アクションボタン
  - 「なぞり書きで練習」ボタン
  - 「自由書きで練習」ボタン

### ④ なぞり書き練習画面
**目的**: ガイドに沿って書く練習

**UI要素**:
- キャンバスエリア（中央）
  - HTML5 Canvasを使用
  - タッチ/マウス/ペン入力に対応
  - 薄いグレーのガイドライン
  - 現在の画をハイライト
  - ユーザーの描画をリアルタイム表示

- リアルタイムフィードバック
  - 筆順が正しい: 緑色で表示
  - 筆順が間違っている: 赤色で警告
  - 画が完了: チェックマーク表示

- コントロール
  - リセットボタン
  - 筆順ガイドを見るボタン
  - 採点ボタン

- 進捗表示
  - 完了した画数 / 総画数
  - プログレスバー

### ⑤ 自由書き練習画面
**目的**: ガイドなしで書く練習

**UI要素**:
- キャンバスエリア（中央）
  - HTML5 Canvasを使用
  - 白紙またはグリッド/マス目表示
  - ユーザーの描画を表示

- コントロール
  - リセットボタン
  - グリッド表示切り替え
  - マス目表示切り替え
  - 筆順ガイドを見るボタン
  - 採点ボタン

- 採点結果表示
  - 総合スコア（100点満点）
  - 筆順スコア（40点）
  - 形の正確性スコア（30点）
  - バランス・美しさスコア（30点）
  - 詳細なフィードバック

### ⑥ 進捗・統計画面
**目的**: 学習の進捗を確認

**UI要素**:
- 全体進捗
  - 円形プログレス（全体進捗率）
  - 習得済み文字数 / 総文字数

- レッスンタイプ別進捗
  - ひらがな進捗
  - カタカナ進捗
  - 各タイプの習得率

- 練習記録
  - 日別の練習時間グラフ（Chart.js等を使用）
  - 週間/月間の練習時間
  - 連続練習日数

- 文字別詳細
  - 各文字の習熟度
  - 最高スコア
  - 練習回数
  - 最後の練習日

- 統計情報
  - 総練習時間
  - 総練習回数
  - 平均スコア
  - 習得済み文字数

---

## 5. データ構造

### 5.1 文字データ
```typescript
interface WritingCharacter {
  id: string;
  character: string; // ひらがな or カタカナ
  lessonType: LessonType;
  strokeOrder: Stroke[]; // 筆順データ
  totalStrokes: number;
}

interface Stroke {
  strokeNumber: number; // 何画目か
  points: Point[]; // 画の座標データ
  startPoint: Point;
  endPoint: Point;
}

interface Point {
  x: number;
  y: number;
}

type LessonType = 'hiragana' | 'katakana';
```

### 5.2 練習記録
```typescript
interface PracticeRecord {
  characterId: string;
  practiceDate: Date;
  mode: PracticeMode; // 筆順モード/美文字モード/スピードモード
  score: number; // 0-100
  strokeOrderScore: number; // 0-40
  shapeScore: number; // 0-30
  balanceScore: number; // 0-30
  practiceTime: number; // 練習時間（秒）
  strokeData: StrokeData[]; // 実際に書いたデータ
}

interface StrokeData {
  strokeNumber: number;
  points: Point[];
  timestamp: Date;
  pressure?: number; // 筆圧（タッチデバイスの場合）
}

type PracticeMode = 'strokeOrder' | 'beautiful' | 'speed';
```

### 5.3 ユーザー進捗
```typescript
interface UserProgress {
  characterProgress: Record<string, CharacterProgress>; // [characterId: progress]
  totalPracticeTime: number; // 秒
  totalPracticeCount: number;
  consecutiveDays: number;
  lastPracticeDate: Date | null;
  firstLaunchDate: Date;
}

interface CharacterProgress {
  masteryLevel: MasteryLevel; // 初級/中級/上級
  bestScore: number;
  practiceCount: number;
  lastPracticeDate: Date | null;
  averageScore: number;
  strokeOrderAccuracy: number; // 筆順の正確性（0-1）
}

enum MasteryLevel {
  Beginner = 0, // 初級: スコア50未満
  Intermediate = 1, // 中級: スコア50-80
  Advanced = 2, // 上級: スコア80以上
}
```

---

## 6. 採点アルゴリズム

### 6.1 筆順スコア（40点満点）
- **判定方法**:
  1. 各画の開始点が正しい位置にあるか（±10ピクセル以内）
  2. 各画の終了点が正しい位置にあるか（±10ピクセル以内）
  3. 画の順序が正しいか
  4. 画の方向が正しいか（上から下、左から右など）

- **スコア計算**:
  - 各画が正しい: +10点（最大40点）
  - 画の順序が間違っている: -5点/画
  - 画の方向が間違っている: -3点/画

### 6.2 形の正確性スコア（30点満点）
- **判定方法**:
  1. 文字のバウンディングボックスの比較
  2. 各画の長さの比較
  3. 画の角度の比較
  4. 文字のアスペクト比の比較

- **スコア計算**:
  - バウンディングボックスの一致度: 10点
  - 各画の長さの一致度: 10点
  - 画の角度の一致度: 10点

### 6.3 バランス・美しさスコア（30点満点）
- **判定方法**:
  1. 文字の中心位置
  2. 各画のバランス
  3. 画と画の間隔
  4. 全体的なプロポーション

- **スコア計算**:
  - 中心位置の正確性: 10点
  - 画のバランス: 10点
  - 間隔の均等性: 10点

---

## 7. 技術要件

### 7.1 フロントエンド
- **フレームワーク**: React 18+ / Next.js 14+（推奨）
- **言語**: TypeScript
- **状態管理**: 
  - React Hooks (`useState`, `useReducer`)
  - 必要に応じて Zustand または Context API
- **スタイリング**: 
  - Tailwind CSS（推奨）
  - または CSS Modules / Styled Components
- **アニメーション**: 
  - Framer Motion（推奨）
  - または CSS Animations / React Spring
- **描画**: 
  - HTML5 Canvas API
  - または SVG + React
- **ルーティング**: Next.js App Router または React Router

### 7.2 データ保存
- **保存先**: 
  - LocalStorage（簡単なデータ）
  - IndexedDB（複雑なデータ、大量データ）
- **形式**: JSON
- **ライブラリ**: 
  - LocalStorage: ネイティブAPI
  - IndexedDB: Dexie.js または idb
- **将来**: 
  - Firebase Firestore
  - Supabase
  - または独自バックエンドAPI

### 7.3 筆順データ
- **形式**: JSON
- **構造**: 各文字の画ごとの座標データ
- **精度**: 300x300ピクセルエリア内の座標
- **保存場所**: `/public/data/stroke-data.json` または API

### 7.4 パフォーマンス
- **描画の滑らかさ**: 60fps
- **採点の速度**: 1秒以内
- **アニメーション**: スムーズな再生
- **ページ読み込み**: 3秒以内（First Contentful Paint）
- **バンドルサイズ**: 200KB以下（gzip圧縮後）

### 7.5 レスポンシブデザイン
- **モバイル**: 320px以上（スマートフォン）
- **タブレット**: 768px以上
- **デスクトップ**: 1024px以上
- **タッチ入力**: マウス/タッチ/ペン入力に対応

### 7.6 ブラウザ対応
- **必須**: 
  - Chrome/Edge（最新版）
  - Safari（最新版）
  - Firefox（最新版）
- **推奨**: 
  - iOS Safari 14+
  - Android Chrome 90+

---

## 8. UI/UXデザイン原則

### 8.1 デザイン原則
- **シンプル**: 余計な要素を排除
- **明確**: 何をすべきかが一目でわかる
- **フィードバック**: リアルタイムでフィードバックを提供
- **達成感**: 小さな成功を積み重ねられる
- **アクセシビリティ**: WCAG 2.1 AA準拠

### 8.2 カラーパレット
- **プライマリ**: ブルー（#007AFF）
- **セカンダリ**: グリーン（#34C759）
- **アクセント**: オレンジ（#FF9500）
- **エラー**: レッド（#FF3B30）
- **成功**: グリーン（#34C759）
- **背景**: ライトモード/ダークモード対応（オプション）

### 8.3 タイポグラフィ
- **見出し**: 32px, Bold
- **本文**: 16px, Regular
- **キャプション**: 14px, Regular
- **フォント**: システムフォントスタック（-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif）

### 8.4 コンポーネント設計
- **アトミックデザイン**: 原子/分子/組織/テンプレート/ページ
- **再利用可能**: 共通コンポーネントの作成
- **一貫性**: デザインシステムの確立

---

## 9. 実装優先順位

### Phase 1: 基本機能（2週間）
1. プロジェクトセットアップ（Next.js + TypeScript + Tailwind CSS）
2. ホーム画面の実装
3. 文字選択画面の実装
4. 筆順ガイド画面の実装（アニメーション）
5. なぞり書き練習画面の実装（Canvas）
6. 基本的な採点機能
7. LocalStorageでのデータ保存

### Phase 2: 練習機能の拡張（1週間）
1. 自由書き練習画面の実装
2. 採点アルゴリズムの改善
3. 進捗管理機能の実装
4. 統計画面の実装（グラフ表示）
5. IndexedDBへの移行（必要に応じて）

### Phase 3: 体験の向上（1週間）
1. アニメーションの最適化
2. フィードバックの改善
3. エラーハンドリング
4. パフォーマンス最適化
5. レスポンシブデザインの調整
6. タッチ入力の最適化

### Phase 4: 微調整（1週間）
1. UI/UXの調整
2. 文言の調整
3. アクセシビリティ対応
4. ブラウザ互換性の確認
5. 最終テスト
6. デプロイ準備

---

## 10. 技術スタック詳細

### 10.1 推奨技術スタック
```
- フレームワーク: Next.js 14+ (App Router)
- 言語: TypeScript 5+
- スタイリング: Tailwind CSS 3+
- 状態管理: Zustand または React Context
- アニメーション: Framer Motion
- データ保存: IndexedDB (Dexie.js)
- グラフ: Chart.js または Recharts
- テスト: Jest + React Testing Library
- ビルドツール: Next.js (Turbopack)
```

### 10.2 プロジェクト構造
```
/
├── app/                    # Next.js App Router
│   ├── page.tsx           # ホーム画面
│   ├── hiragana/          # ひらがな関連
│   ├── katakana/          # カタカナ関連
│   └── progress/          # 進捗画面
├── components/            # Reactコンポーネント
│   ├── ui/               # 基本UIコンポーネント
│   ├── canvas/           # Canvas関連コンポーネント
│   └── charts/           # グラフコンポーネント
├── lib/                   # ユーティリティ
│   ├── scoring/          # 採点アルゴリズム
│   ├── storage/          # データ保存
│   └── stroke-data/      # 筆順データ
├── types/                 # TypeScript型定義
├── public/                # 静的ファイル
│   └── data/             # 筆順データJSON
└── styles/                # グローバルスタイル
```

### 10.3 Canvas実装の詳細
- **ライブラリ**: ネイティブCanvas API
- **イベント処理**: 
  - `mousedown`, `mousemove`, `mouseup`（マウス）
  - `touchstart`, `touchmove`, `touchend`（タッチ）
  - `pointerdown`, `pointermove`, `pointerup`（統一API）
- **描画**: `CanvasRenderingContext2D`
- **パフォーマンス**: `requestAnimationFrame`を使用

---

## 11. 将来の拡張機能

### Phase 2以降
- **漢字練習**: 常用漢字の練習機能
- **単語練習**: 単語を書く練習
- **文章練習**: 短文を書く練習
- **クラウド同期**: Firebase/Supabaseでの進捗同期
- **ユーザー認証**: アカウント機能
- **ソーシャル機能**: 友達と進捗を共有
- **AI採点**: より正確な採点アルゴリズム（機械学習）
- **動画チュートリアル**: プロによる書き方動画
- **PWA対応**: オフライン対応、ホーム画面追加
- **多言語対応**: i18n（英語、中国語など）

---

## 12. 成功基準

### MVP成功基準
- ✅ 筆順ガイドが正しく表示される
- ✅ なぞり書きがスムーズに動作する（マウス/タッチ対応）
- ✅ 採点が1秒以内に完了する
- ✅ 進捗が正しく保存される（LocalStorage/IndexedDB）
- ✅ ユーザーが「書けるようになった」と感じる
- ✅ モバイル/タブレット/PCで正常に動作する
- ✅ 主要ブラウザで動作する

### 品質基準
- クラッシュ率: 0%
- アニメーション: 60fps維持
- 採点精度: 80%以上
- ページ読み込み時間: 3秒以内
- ユーザー満足度: 4.0/5.0以上
- Lighthouseスコア: 90以上（Performance, Accessibility, Best Practices）

---

## 13. リスク管理

### 技術的リスク
- **筆順データの精度**: 正確な筆順データの取得が困難
  - **対策**: 専門家による検証、複数ソースの比較

- **採点アルゴリズムの精度**: 正確な採点が困難
  - **対策**: 機械学習の導入、ユーザーフィードバックの収集

- **Canvas描画のパフォーマンス**: 複雑な描画でパフォーマンス低下
  - **対策**: 最適化、`requestAnimationFrame`の使用、必要に応じてWebGL

- **ブラウザ互換性**: 古いブラウザでの動作問題
  - **対策**: ポリフィルの使用、プログレッシブエンハンスメント

- **タッチ入力の精度**: タッチデバイスでの描画精度
  - **対策**: タッチイベントの最適化、ペン入力のサポート

### ユーザー体験のリスク
- **練習の退屈さ**: 繰り返し練習が退屈になる可能性
  - **対策**: ゲーミフィケーション要素の追加、達成感の設計

- **難易度の調整**: 難しすぎる/簡単すぎる
  - **対策**: 段階的な難易度設定、ユーザーフィードバックの収集

- **モバイルでの使いやすさ**: 小さな画面での操作の困難さ
  - **対策**: レスポンシブデザイン、タッチ操作の最適化

---

## 14. メトリクスと分析

### 追跡すべきメトリクス
- セッション時間
- レッスン完了率
- 採点スコアの分布
- 文字別の練習回数
- エラー率（筆順エラー、形のエラー）
- リテンション率（Day1, Day7, Day30）
- デバイス別の使用状況（PC/タブレット/モバイル）
- ブラウザ別の使用状況

### 分析ツール
- **Google Analytics 4**: ユーザー行動分析
- **Custom Events**: アプリ内イベントの追跡
- **Error Tracking**: Sentry等のエラートラッキング

### 分析ダッシュボード
- ユーザーの学習パターン
- 難しい文字の特定
- 改善が必要な機能の特定
- パフォーマンスメトリクス

---

## 15. デプロイとホスティング

### 15.1 デプロイ先
- **推奨**: Vercel（Next.jsに最適化）
- **代替**: 
  - Netlify
  - Cloudflare Pages
  - AWS Amplify

### 15.2 CI/CD
- **GitHub Actions**: 自動デプロイ
- **ブランチ戦略**: 
  - `main`: 本番環境
  - `develop`: 開発環境
  - `feature/*`: 機能ブランチ

### 15.3 環境変数
- 開発環境と本番環境の分離
- 環境変数の適切な管理

---

## 16. セキュリティ

### 16.1 データ保護
- クライアントサイドのみのデータ保存（MVP）
- 将来的な認証実装時のセキュリティ対策

### 16.2 パフォーマンスセキュリティ
- XSS対策: Reactのデフォルトエスケープ
- CSRF対策: 必要に応じて実装

---

## 17. このMVPの「役割」

このアプリは：
- ❌ 完成形ではない
- ❌ 全ての機能が揃っているわけではない
- ✅ **「書けるようになる」という体験を提供する装置**
- ✅ **ライティング特化Webアプリの可能性を証明する装置**
- ✅ **クロスプラットフォーム（PC/タブレット/モバイル）で動作するWebアプリ**

---

## 18. 次のステップ

### MVP完了後
1. ユーザーフィードバックの収集
2. 使用データの分析
3. 改善点の特定
4. Phase 2の機能追加
5. PWA対応の検討

### 成功時（KPI達成後）
1. 漢字練習機能の追加
2. より高度な採点アルゴリズムの実装
3. クラウド同期機能の追加
4. ユーザー認証の実装
5. マーケティングの開始
6. 多言語対応

---

## 19. 開発環境セットアップ

### 19.1 必要なツール
- Node.js 18+ 
- npm または yarn または pnpm
- Git
- コードエディタ（VS Code推奨）

### 19.2 セットアップコマンド
```bash
# プロジェクト作成
npx create-next-app@latest japanese-writing-master --typescript --tailwind --app

# 依存関係のインストール
npm install

# 開発サーバー起動
npm run dev

# ビルド
npm run build

# 本番環境での起動
npm start
```

---

**最後に**

これは **「完璧なライティングWebアプリを作る要件定義」ではなく、「書けるようになる体験を提供できるかを証明するWebアプリの要件定義」** です。

Web技術を活用することで、iOS/Android/PCのすべてのプラットフォームで動作するアプリを一度に開発できます。

Cursorがあるあなたなら、数週間でここまで作れる。



